# DM.03 Implement document model reducers

For this scenario, you will write TypeScript code in the active Reactor Package project directory that you can find through `reactor_pkgmgr` MCP tool.
    - Use the `reactor_pkgmgr` MCP tool to (re)start Vetra Studio and Switchboard if needed.
    - Use the `reactor_pkgmgr` MCP tool to inspect the logs
    
Read the `AGENTS.md` in the project directory for best practices

Use the `active-project-vetra` MCP tool 
    - to access the Vetra drive and inspect the document model specification document
    - to access the preview drive and create test documents when appropriate

Do not run the `ph vetra` or `pnpm generate` commands for anything, instead use the `reactor_pkgmgr` MCP tool

Code is regenerated automatically by Vetra.
    - Review bugs and errors in the GraphQL types if the code generator is stuck
    - Review and update the document model specification in the Vetra drive to fix type errors in the generated code
    - Consider restarting the project (/ the Vetra service) through the `reactor_pkgmgr` tool if needed
    
## DM.03.1 Confirm that the reducers boilerplate has been generated by Vetra

- Read the document model specifications in the Vetra drive for context

- In the `./src/document-models` folder, confirm you see the generated types and boilerplate code for reducers
    - Review their functionality
    - Identify reducers that are not yet implemented
    - Identify reducers that are incompletely implemented or need updates to conform with the specification document in Vetra drive

- Run `pnpm test` to know which tests are currently failing
- Run `pnpm build` to detect type errors

## DM.03.2 Implement and test the reducers one module at a time

Consider which order you will implement the operation modules in: 
    - Try to focus on the most complex modules first and verify the reducers' behavior
    - Save simple data setters until last unless they are a dependency

For each operations module with reducers that require work:
    1. Write the reducer implementation to the .ts file

    2. Design and write one or more unit tests to verify the expected behavior
        - **IMPORTANT** Don't rely only on the generated tests as they do not test the actual business logic

    3. Rerun `pnpm test` and `pnpm build` until all issues are resolved
    4. Commit your changes once the module is completed

Do not proceed to the next reducers module until the last one is fixed

If you need to make changes in the document model specification in Vetra drive, always verify through the `active-project-vetra` MCP tool 
that the changes have been correctly applied.

## DM.03.3 Provide a stakeholder update

- Verify that tests are passing via `pnpm test`
- Verify that no type errors remain with `pnpm build`
- Once all reducers are finished, provide an update to the stakeholder.
- If there are issues that you cannot resolve, make sure to inform the stakeholder